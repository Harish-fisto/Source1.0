<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leave Request System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }


        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8f9fa;
            color: #333;
        }

        .header {
            background: white;
            padding: 1rem 2rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .header .welcome {
            color: #666;
            font-size: 0.9rem;
        }

        .logout-btn {
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .main {
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .stat-icon.blue { background: #e3f2fd; color: #1976d2; }
        .stat-icon.orange { background: #fff3e0; color: #f57c00; }
        .stat-icon.green { background: #e8f5e8; color: #388e3c; }
        .stat-icon.red { background: #ffebee; color: #d32f2f; }

        .stat-info h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .stat-info p {
            color: #666;
            font-size: 0.9rem;
        }

        .section {
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .section-header {
            padding: 1.5rem 2rem;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .section-subtitle {
            color: #666;
            font-size: 0.9rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #1a1a1a;
            color: white;
        }

        .btn-primary:hover {
            background: #333;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .leave-item {
            padding: 1.5rem 2rem;
            border-bottom: 1px solid #eee;
        }

        .leave-item:last-child {
            border-bottom: none;
        }

        .leave-header {
            display: flex;
            justify-content: between;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 0.75rem;
        }

        .leave-title {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-approved {
            background: #d4edda;
            color: #155724;
        }

        .status-rejected {
            background: #f8d7da;
            color: #721c24;
        }

        .leave-details {
            color: #666;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .leave-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 0.75rem;
        }

        .leave-actions {
            display: flex;
            gap: 0.5rem;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 1.5rem 2rem;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }

        .modal-body {
            padding: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        #halfDayPeriodGroup label {
        margin-right: 10px; /* adds 10px space after each label */
        }


        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .form-control:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
        }

        .date-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .duration-info {
            background: #e3f2fd;
            padding: 0.75rem;
            border-radius: 6px;
            margin-top: 0.5rem;
            color: #1976d2;
            font-weight: 500;
        }

        .modal-footer {
            padding: 1rem 2rem;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th,
        .table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #666;
        }

        .tabs {
            display: flex;
            gap: 0.25rem;
            margin-bottom: 2rem;
        }

        .tab {
            padding: 0.75rem 1rem;
            background: none;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            color: #666;
        }

        .tab.active {
            background: #1a1a1a;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .approval-card {
            background: white;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .approval-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .employee-info h4 {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .employee-info p {
            color: #666;
            font-size: 0.9rem;
        }

        .approval-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .detail-item {
            font-size: 0.9rem;
        }

        .detail-label {
            color: #666;
            margin-bottom: 0.25rem;
        }

        .detail-value {
            font-weight: 500;
        }

        .comments {
            background: #f8f9fa;
            padding: 0.75rem;
            border-radius: 6px;
            margin-top: 1rem;
            font-size: 0.9rem;
            color: #666;
        }

        .leave-balance {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }

        .balance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .balance-item {
            text-align: center;
            background: rgba(255,255,255,0.1);
            padding: 1rem;
            border-radius: 6px;
        }

        .balance-item h4 {
            font-size: 1.5rem;
            margin-bottom: 0.25rem;
        }

        .balance-item p {
            font-size: 0.85rem;
            opacity: 0.9;
        }

        .calendar-view {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .calendar-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .calendar-nav {
            display: flex;
            gap: 0.5rem;
        }

        .nav-btn {
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 0.5rem;
            cursor: pointer;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: #ddd;
            border-radius: 6px;
            overflow: hidden;
        }

        .calendar-day {
            background: white;
            padding: 0.75rem;
            min-height: 60px;
            font-size: 0.9rem;
            position: relative;
        }

        .calendar-day.other-month {
            color: #ccc;
            background: #f8f9fa;
        }

        .calendar-day.has-leave {
            background: #e3f2fd;
        }

        .calendar-day.weekend {
            background: #f8f9fa;
        }

        .leave-indicator {
            position: absolute;
            bottom: 2px;
            left: 2px;
            right: 2px;
            height: 3px;
            border-radius: 2px;
        }

        .leave-indicator.approved { background: #28a745; }
        .leave-indicator.pending { background: #ffc107; }
        .leave-indicator.rejected { background: #dc3545; }

        .notification {
            position: fixed;
            top: 1rem;
            right: 1rem;
            padding: 1rem 1.5rem;
            border-radius: 6px;
            color: white;
            font-weight: 500;
            z-index: 1001;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success { background: #28a745; }
        .notification.error { background: #dc3545; }
        .notification.info { background: #17a2b8; }

        .team-calendar {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .team-member {
            display: flex;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid #eee;
        }

        .team-member:last-child {
            border-bottom: none;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e3f2fd;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #1976d2;
            margin-right: 1rem;
        }

        .member-info {
            flex: 1;
        }

        .member-status {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .status-available {
            background: #d4edda;
            color: #155724;
        }

        .status-on-leave {
            background: #fff3cd;
            color: #856404;
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .quick-action {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .quick-action:hover {
            border-color: #007bff;
            box-shadow: 0 2px 8px rgba(0,123,255,0.1);
        }

        .quick-action-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .analytics-card {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 1rem;
        }

        .chart-placeholder {
            height: 200px;
            background: #f8f9fa;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .main {
                padding: 1rem;
            }

            .stats {
                grid-template-columns: 1fr;
            }

            .date-row {
                grid-template-columns: 1fr;
            }

            .approval-details {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div>
            <h1 id="pageTitle">Leave Request System</h1>
            <div class="welcome" id="welcomeText">Welcome, John Doe</div>
        </div>
        <button class="logout-btn" onclick="logout()">
            <span>‚Üó</span> Logout
        </button>
    </div>

    <div class="main">
        <!-- Employee Dashboard -->
        <div id="employeeDashboard">
            <!-- Leave Balance Overview -->
            <div class="leave-balance">
                <h3>Leave Balance Overview</h3>
                <div class="balance-grid">
                    <div class="balance-item">
                        <h4>20</h4>
                        <p>Annual Leave</p>
                    </div>
                    <div class="balance-item">
                        <h4>10</h4>
                        <p>Sick Leave</p>
                    </div>
                    <div class="balance-item">
                        <h4>3</h4>
                        <p>Personal Leave</p>
                    </div>
                    <div class="balance-item">
                        <h4>15</h4>
                        <p>Total Used</p>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <div class="quick-action" onclick="openNewRequestModal()">
                    <div class="quick-action-icon">üìù</div>
                    <h4>New Request</h4>
                    <p>Submit leave application</p>
                </div>
                <div class="quick-action" onclick="viewCalendar()">
                    <div class="quick-action-icon">üìÖ</div>
                    <h4>View Calendar</h4>
                    <p>See leave schedule</p>
                </div>
                <div class="quick-action" onclick="viewTeamStatus()">
                    <div class="quick-action-icon">üë•</div>
                    <h4>Team Status</h4>
                    <p>Check team availability</p>
                </div>
            </div>

            <div class="stats">
                <div class="stat-card">
                    <div class="stat-icon blue">üìã</div>
                    <div class="stat-info">
                        <h3 id="totalRequests">1</h3>
                        <p>Total Requests</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon orange">‚è≥</div>
                    <div class="stat-info">
                        <h3 id="pendingRequests">1</h3>
                        <p>Pending</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon green">‚úì</div>
                    <div class="stat-info">
                        <h3 id="approvedRequests">0</h3>
                        <p>Approved</p>
                    </div>
                </div>
            </div>

            <!-- Calendar View -->
            <div id="calendarSection" class="calendar-view" style="display: none;">
                <div class="calendar-header">
                    <h3>Leave Calendar - <span id="currentMonth">September 2025</span></h3>
                    <div class="calendar-nav">
                        <button class="nav-btn" onclick="previousMonth()">‚Äπ</button>
                        <button class="nav-btn" onclick="nextMonth()">‚Ä∫</button>
                        <button class="nav-btn" onclick="toggleCalendar()">Close</button>
                    </div>
                </div>
                <div class="calendar-grid" id="calendarGrid">
                    <!-- Calendar will be populated here -->
                </div>
            </div>

            <!-- Team Status -->
            <div id="teamSection" class="team-calendar" style="display: none;">
                <div class="section-header">
                    <h3>Team Availability</h3>
                    <button class="nav-btn" onclick="toggleTeamStatus()">Close</button>
                </div>
                <div class="team-member">
                    <div class="avatar">JD</div>
                    <div class="member-info">
                        <div style="font-weight: 600;">John Doe</div>
                        <div style="color: #666; font-size: 0.9rem;">Engineering</div>
                    </div>
                    <div class="member-status status-on-leave">On Leave</div>
                </div>
                <div class="team-member">
                    <div class="avatar">JS</div>
                    <div class="member-info">
                        <div style="font-weight: 600;">Jane Smith</div>
                        <div style="color: #666; font-size: 0.9rem;">Marketing</div>
                    </div>
                    <div class="member-status status-available">Available</div>
                </div>
                <div class="team-member">
                    <div class="avatar">MJ</div>
                    <div class="member-info">
                        <div style="font-weight: 600;">Mike Johnson</div>
                        <div style="color: #666; font-size: 0.9rem;">Sales</div>
                    </div>
                    <div class="member-status status-available">Available</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div>
                        <div class="section-title">My Leave Requests</div>
                        <div class="section-subtitle">View and manage your leave requests</div>
                    </div>
                    <button class="btn btn-primary" onclick="openNewRequestModal()">
                        <span>+</span> New Request
                    </button>
                </div>
                <div id="leaveRequests">
                    <!-- Leave requests will be populated here -->
                </div>
            </div>
        </div>

        <!-- HR Dashboard -->
        <div id="hrDashboard" style="display: none;">
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-icon blue">üë•</div>
                    <div class="stat-info">
                        <h3>3</h3>
                        <p>Total Users</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon blue">üìã</div>
                    <div class="stat-info">
                        <h3 id="hrTotalRequests">3</h3>
                        <p>Total Requests</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon orange">‚è≥</div>
                    <div class="stat-info">
                        <h3 id="hrPendingRequests">0</h3>
                        <p>Pending</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon green">‚úì</div>
                    <div class="stat-info">
                        <h3 id="hrApprovedRequests">2</h3>
                        <p>Approved</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon red">‚úï</div>
                    <div class="stat-info">
                        <h3 id="hrRejectedRequests">1</h3>
                        <p>Rejected</p>
                    </div>
                </div>
            </div>

            <div class="tabs">
                <button class="tab active" onclick="switchTab('approval')">Approval Queue</button>
                <button class="tab" onclick="switchTab('users')">User Management</button>
                <button class="tab" onclick="switchTab('reports')">Leave Reports</button>
                <button class="tab" onclick="switchTab('analytics')">Analytics</button>
            </div>

            <div id="approvalTab" class="tab-content active">
                <div class="section">
                    <div class="section-header">
                        <div>
                            <div class="section-title">Pending Approvals</div>
                            <div class="section-subtitle">Review and approve leave requests</div>
                        </div>
                    </div>
                    <div id="pendingApprovals">
                        <div style="padding: 2rem; text-align: center; color: #666;">
                            No pending approvals at the moment
                        </div>
                    </div>
                </div>
            </div>

            <div id="usersTab" class="tab-content">
                <div class="section">
                    <div class="section-header">
                        <div>
                            <div class="section-title">User Management</div>
                            <div class="section-subtitle">Manage employee profiles and leave balances</div>
                        </div>
                        <button class="btn btn-primary" onclick="addNewUser()">
                            <span>+</span> Add User
                        </button>
                    </div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Employee</th>
                                <th>Department</th>
                                <th>Annual Leave</th>
                                <th>Sick Leave</th>
                                <th>Used This Year</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 0.75rem;">
                                        <div class="avatar">JD</div>
                                        <div>
                                            <div style="font-weight: 600;">John Doe</div>
                                            <div style="color: #666; font-size: 0.85rem;">john.doe@company.com</div>
                                        </div>
                                    </div>
                                </td>
                                <td>Engineering</td>
                                <td>20 days</td>
                                <td>10 days</td>
                                <td>5 days</td>
                                <td>
                                    <button class="btn btn-secondary" style="font-size: 0.8rem; padding: 0.5rem 0.75rem;">Edit</button>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 0.75rem;">
                                        <div class="avatar">JS</div>
                                        <div>
                                            <div style="font-weight: 600;">Jane Smith</div>
                                            <div style="color: #666; font-size: 0.85rem;">jane.smith@company.com</div>
                                        </div>
                                    </div>
                                </td>
                                <td>Marketing</td>
                                <td>22 days</td>
                                <td>12 days</td>
                                <td>2 days</td>
                                <td>
                                    <button class="btn btn-secondary" style="font-size: 0.8rem; padding: 0.5rem 0.75rem;">Edit</button>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 0.75rem;">
                                        <div class="avatar">MJ</div>
                                        <div>
                                            <div style="font-weight: 600;">Mike Johnson</div>
                                            <div style="color: #666; font-size: 0.85rem;">mike.johnson@company.com</div>
                                        </div>
                                    </div>
                                </td>
                                <td>Sales</td>
                                <td>25 days</td>
                                <td>10 days</td>
                                <td>0 days</td>
                                <td>
                                    <button class="btn btn-secondary" style="font-size: 0.8rem; padding: 0.5rem 0.75rem;">Edit</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="analyticsTab" class="tab-content">
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-icon blue">üìä</div>
                        <div class="stat-info">
                            <h3>75%</h3>
                            <p>Approval Rate</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon green">‚è±Ô∏è</div>
                        <div class="stat-info">
                            <h3>1.2</h3>
                            <p>Avg Days to Approve</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon orange">üèñÔ∏è</div>
                        <div class="stat-info">
                            <h3>18.5</h3>
                            <p>Avg Leave Days/Employee</p>
                        </div>
                    </div>
                </div>

                <div class="analytics-card">
                    <h4>Monthly Leave Trends</h4>
                    <div class="chart-placeholder">
                        üìà Chart: Monthly leave requests over time would be displayed here
                    </div>
                </div>

                <div class="analytics-card">
                    <h4>Department Breakdown</h4>
                    <div class="chart-placeholder">
                        ü•ß Chart: Leave requests by department would be displayed here
                    </div>
                </div>
            </div>

            <div id="reportsTab" class="tab-content">
                <div class="section">
                    <div class="section-header">
                        <div>
                            <div class="section-title">Leave Reports</div>
                            <div class="section-subtitle">View and export leave request reports</div>
                        </div>
                        <button class="btn btn-primary" onclick="exportToExcel()">
                            <span>‚Üì</span> Export to Excel
                        </button>
                    </div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Employee</th>
                                <th>Department</th>
                                <th>Leave Type</th>
                                <th>Duration</th>
                                <th>Status</th>
                                <th>Submitted</th>
                            </tr>
                        </thead>
                        <tbody id="reportsTableBody">
                            <tr>
                                <td>John Doe</td>
                                <td>Engineering</td>
                                <td>Annual</td>
                                <td>5 days<br><small style="color: #666;">8/1/2025 - 8/5/2025</small></td>
                                <td><span class="status-badge status-approved">Approved</span></td>
                                <td>7/15/2025</td>
                            </tr>
                            <tr>
                                <td>Jane Smith</td>
                                <td>Marketing</td>
                                <td>Sick</td>
                                <td>2 days<br><small style="color: #666;">7/28/2025 - 7/29/2025</small></td>
                                <td><span class="status-badge status-approved">Approved</span></td>
                                <td>7/20/2025</td>
                            </tr>
                            <tr>
                                <td>Mike Johnson</td>
                                <td>Sales</td>
                                <td>Annual</td>
                                <td>6 days<br><small style="color: #666;">9/15/2025 - 9/20/2025</small></td>
                                <td><span class="status-badge status-rejected">Rejected</span></td>
                                <td>7/25/2025</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- New Leave Request Modal -->
    <div id="newRequestModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div>
                    <div class="modal-title">New Leave Request</div>
                    <div style="color: #666; font-size: 0.9rem;">Submit a new leave request for approval</div>
                </div>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="leaveRequestForm">
                    <div class="form-group">
                        <label class="form-label">Leave Type</label>
                        <select class="form-control" id="leaveType" required>
                            <option value="">Select leave type</option>
                            <option value="Annual Leave">Annual Leave</option>
                            <option value="Sick Leave">Sick Leave</option>
                            <option value="Maternity/Paternity Leave">Maternity/Paternity Leave</option>
                            <option value="Emergency Leave">Emergency Leave</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Number of Days</label>
                        <select class="form-control" id="numberOfDays" required onchange="handleDaysChange()">
                            <option value="">Select duration</option>
                            <option value="0.5">Half Day</option>
                            <option value="1">1 Day</option>
                            <option value="2">2 Days</option>
                            <option value="3">3 Days</option>
                            <option value="4">4 Days</option>
                            <option value="5">5 Days</option>
                            <option value="custom">More than 5 days (Custom)</option>
                        </select>
                    </div>

                  <!-- Leave Date (single date for half/1 day) -->
                    <div id="singleDateGroup" class="form-group" style="display: none;">
                        <label class="form-label">Leave Date</label>
                        <input type="date" class="form-control" id="singleDate">
                    </div>

                    <!-- Half Day Period (only if half day selected) -->
                    <div id="halfDayPeriodGroup" class="form-group" style="display: none;">
                        <label class="form-label">Half Day Period</label><br>
                        <label><input type="radio" name="halfDayPeriod" value="Morning"> Morning</label>
                        <label><input type="radio" name="halfDayPeriod" value="Afternoon"> Afternoon</label>
                    </div>

                    <!-- Start Date -->
                    <div id="startDateGroup" class="form-group" style="display: none;">
                        <label class="form-label">Start Date</label>
                        <input type="date" class="form-control" id="startDate">
                    </div>

                    <!-- End Date -->
                    <div id="endDateGroup" class="form-group" style="display: none;">
                        <label class="form-label">End Date</label>
                        <input type="date" class="form-control" id="endDate">
                    </div>

                    <!-- Custom Duration -->
                    <div id="customDurationGroup" class="form-group" style="display: none;">
                        <label class="form-label">Custom Duration (Days)</label>
                        <input type="number" class="form-control" id="customDuration" min="6" max="30" placeholder="Enter number of days">
                    </div>


                    <div id="durationDisplay" class="duration-info" style="display: none;">
                        Duration: <span id="durationText">0 days</span>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Reason</label>
                        <textarea class="form-control" id="reason" rows="3" placeholder="Provide a reason for your leave request" required></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                <button type="submit" class="btn btn-primary" onclick="submitLeaveRequest()">Submit Request</button>
            </div>
        </div>
    </div>

    <script>
        // Sample data
        let currentUser = 'employee'; // 'employee' or 'hr'
        let leaveRequests = [
            {
                id: 1,
                employee: 'John Doe',
                department: 'Engineering',
                type: 'Annual Leave',
                reason: 'Family vacation',
                startDate: '2025-08-01',
                endDate: '2025-08-05',
                duration: 5,
                status: 'pending',
                submitted: '2025-07-15',
                comments: ''
            }
        ];

        let allRequests = [
            {
                id: 1,
                employee: 'John Doe',
                department: 'Engineering',
                type: 'Annual',
                reason: 'Family vacation',
                startDate: '2025-08-01',
                endDate: '2025-08-05',
                duration: 5,
                status: 'approved',
                submitted: '2025-07-15',
                approved: '2025-07-16'
            },
            {
                id: 2,
                employee: 'Jane Smith',
                department: 'Marketing',
                type: 'Sick',
                reason: 'Medical appointment',
                startDate: '2025-07-28',
                endDate: '2025-07-29',
                duration: 2,
                status: 'approved',
                submitted: '2025-07-20',
                approved: '2025-07-21'
            },
            {
                id: 3,
                employee: 'Mike Johnson',
                department: 'Sales',
                type: 'Annual',
                reason: 'Wedding anniversary trip',
                startDate: '2025-09-15',
                endDate: '2025-09-20',
                duration: 6,
                status: 'rejected',
                submitted: '2025-07-25',
                approved: '2025-07-26',
                comments: 'Insufficient leave balance'
            }
        ];

        function initializeApp() {
            if (currentUser === 'hr') {
                switchToHRView();
            } else {
                switchToEmployeeView();
            }
            updateDashboard();
        }

        function switchToHRView() {
            currentUser = 'hr';
            document.getElementById('pageTitle').textContent = 'HR Management Dashboard';
            document.getElementById('welcomeText').textContent = 'Welcome, HR Admin';
            document.getElementById('employeeDashboard').style.display = 'none';
            document.getElementById('hrDashboard').style.display = 'block';
            updateHRStats();
        }

        function switchToEmployeeView() {
            currentUser = 'employee';
            document.getElementById('pageTitle').textContent = 'Leave Request System';
            document.getElementById('welcomeText').textContent = 'Welcome, John Doe';
            document.getElementById('employeeDashboard').style.display = 'block';
            document.getElementById('hrDashboard').style.display = 'none';
            renderLeaveRequests();
        }

        function updateDashboard() {
            if (currentUser === 'employee') {
                const userRequests = leaveRequests.filter(req => req.employee === 'John Doe');
                const pending = userRequests.filter(req => req.status === 'pending').length;
                const approved = userRequests.filter(req => req.status === 'approved').length;
                
                document.getElementById('totalRequests').textContent = userRequests.length;
                document.getElementById('pendingRequests').textContent = pending;
                document.getElementById('approvedRequests').textContent = approved;
                
                renderLeaveRequests();
            } else {
                updateHRStats();
            }
        }

        function updateHRStats() {
            const pending = allRequests.filter(req => req.status === 'pending').length;
            const approved = allRequests.filter(req => req.status === 'approved').length;
            const rejected = allRequests.filter(req => req.status === 'rejected').length;
            
            document.getElementById('hrTotalRequests').textContent = allRequests.length;
            document.getElementById('hrPendingRequests').textContent = pending;
            document.getElementById('hrApprovedRequests').textContent = approved;
            document.getElementById('hrRejectedRequests').textContent = rejected;
            
            renderPendingApprovals();
        }

        function renderLeaveRequests() {
            const container = document.getElementById('leaveRequests');
            const userRequests = currentUser === 'employee' ? 
                leaveRequests.filter(req => req.employee === 'John Doe') : 
                leaveRequests;

            if (userRequests.length === 0) {
                container.innerHTML = '<div style="padding: 2rem; text-align: center; color: #666;">No leave requests found</div>';
                return;
            }

            container.innerHTML = userRequests.map(request => {
                let durationText = `${request.duration} day${request.duration !== 1 ? 's' : ''}`;
                if (request.duration === 0.5) {
                    durationText = `Half Day${request.halfDayPeriod ? ` (${request.halfDayPeriod})` : ''}`;
                }
                
                let dateText = request.startDate === request.endDate ? 
                    request.startDate : 
                    `${request.startDate} - ${request.endDate}`;

                return `
                    <div class="leave-item">
                        <div class="leave-header">
                            <div class="leave-title">
                                ${request.type}
                                <span class="status-badge status-${request.status}">${request.status.charAt(0).toUpperCase() + request.status.slice(1)}</span>
                            </div>
                        </div>
                        <div class="leave-details">
                            ${request.reason}<br>
                            Duration: ${dateText} (${durationText})
                        </div>
                        <div class="leave-meta">
                            <div style="font-size: 0.85rem; color: #666;">
                                Submitted: ${request.submitted}
                                ${request.approved ? `<br>Approved: ${request.approved}` : ''}
                                ${request.comments ? `<br>Comments: ${request.comments}` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderPendingApprovals() {
            const container = document.getElementById('pendingApprovals');
            const pending = allRequests.filter(req => req.status === 'pending');

            if (pending.length === 0) {
                container.innerHTML = '<div style="padding: 2rem; text-align: center; color: #666;">No pending approvals at the moment</div>';
                return;
            }

            container.innerHTML = pending.map(request => `
                <div class="approval-card">
                    <div class="approval-header">
                        <div class="employee-info">
                            <h4>${request.employee}</h4>
                            <p>${request.department}</p>
                        </div>
                        <div class="leave-actions">
                            <button class="btn btn-success" onclick="approveRequest(${request.id})">
                                ‚úì Approve
                            </button>
                            <button class="btn btn-danger" onclick="rejectRequest(${request.id})">
                                ‚úï Reject
                            </button>
                        </div>
                    </div>
                    <div class="approval-details">
                        <div class="detail-item">
                            <div class="detail-label">Leave Type:</div>
                            <div class="detail-value">${request.type}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Duration:</div>
                            <div class="detail-value">${request.duration} days</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Start Date:</div>
                            <div class="detail-value">${request.startDate}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">End Date:</div>
                            <div class="detail-value">${request.endDate}</div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Reason:</div>
                        <div class="detail-value">${request.reason}</div>
                    </div>
                </div>
            `).join('');
        }

        function approveRequest(id) {
            const request = allRequests.find(req => req.id === id);
            if (request) {
                request.status = 'approved';
                request.approved = new Date().toISOString().split('T')[0];
                updateHRStats();
            }
        }

        function rejectRequest(id) {
            const reason = prompt('Please provide a reason for rejection:');
            if (reason) {
                const request = allRequests.find(req => req.id === id);
                if (request) {
                    request.status = 'rejected';
                    request.approved = new Date().toISOString().split('T')[0];
                    request.comments = reason;
                    updateHRStats();
                }
            }
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab + 'Tab').classList.add('active');
        }

        function openNewRequestModal() {
            document.getElementById('newRequestModal').classList.add('active');
            // Set min date to today
            document.getElementById('startDate').min = new Date().toISOString().split('T')[0];
            document.getElementById('endDate').min = new Date().toISOString().split('T')[0];
        }

        function closeModal() {
            document.getElementById('newRequestModal').classList.remove('active');
            document.getElementById('leaveRequestForm').reset();
            document.getElementById('durationDisplay').style.display = 'none';
        }

        function calculateDuration() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            
            if (startDate && endDate) {
                const start = new Date(startDate);
                const end = new Date(endDate);
                const timeDiff = end.getTime() - start.getTime();
                const dayDiff = Math.ceil(timeDiff / (1000 * 3600 * 24)) + 1;
                
                if (dayDiff > 0) {
                    document.getElementById('durationText').textContent = `${dayDiff} days`;
                    document.getElementById('durationDisplay').style.display = 'block';
                } else {
                    document.getElementById('durationDisplay').style.display = 'none';
                }
            } else {
                document.getElementById('durationDisplay').style.display = 'none';
            }
        }

        function submitLeaveRequest() {
        const form = document.getElementById('leaveRequestForm');
        if (!form.checkValidity()) {
            form.reportValidity();
            return;
        }

        const leaveType = document.getElementById('leaveType').value;
        const numberOfDays = document.getElementById('numberOfDays').value;
        const reason = document.getElementById('reason').value;
        let startDate = '';
        let endDate = '';
        let duration = 0;

        if (numberOfDays === '0.5' || numberOfDays === '1') {
            // For half-day or 1-day leave
            startDate = document.getElementById('singleDate').value;
            endDate = startDate;
            duration = parseFloat(numberOfDays);

            if (numberOfDays === '0.5') {
                const period = document.querySelector('input[name="halfDayPeriod"]:checked');
                if (!period) {
                    alert("Please select Morning or Afternoon for half-day leave.");
                    return;
                }
            }

        } else if (numberOfDays === 'custom') {
            // Custom duration with date range
            startDate = document.getElementById('startDate').value;
            endDate = document.getElementById('endDate').value;
            const customValue = parseInt(document.getElementById('customDuration').value);
            if (!customValue || customValue < 6) {
                alert("Please enter a valid custom duration (minimum 6 days).");
                return;
            }
            duration = customValue;
        } else {
            // Standard multi-day leave (2‚Äì5 days)
            startDate = document.getElementById('startDate').value;
            endDate = document.getElementById('endDate').value;
            const start = new Date(startDate);
            const end = new Date(endDate);
            const timeDiff = end.getTime() - start.getTime();
            duration = Math.ceil(timeDiff / (1000 * 3600 * 24)) + 1;

            if (duration <= 0) {
                alert("End date must be after start date.");
                return;
            }
        }

        const newRequest = {
            id: Date.now(),
            employee: 'John Doe', // Replace with dynamic user
            department: 'Engineering',
            type: leaveType,
            reason: reason,
            startDate: startDate,
            endDate: endDate,
            duration: duration,
            status: 'pending',
            submitted: new Date().toISOString().split('T')[0],
            comments: ''
        };

        leaveRequests.push(newRequest);
        allRequests.push(newRequest);

        closeModal();
        updateDashboard(); // Make sure this function is implemented elsewhere

        alert('Leave request submitted successfully!');
    }

    function handleDaysChange() {
    const duration = document.getElementById('numberOfDays').value;

    // Element references
    const singleDateGroup = document.getElementById('singleDateGroup'); // Leave Date
    const halfDayPeriodGroup = document.getElementById('halfDayPeriodGroup'); // AM/PM
    const startDate = document.getElementById('startDate');
    const endDate = document.getElementById('endDate');
    const startDateGroup = document.getElementById('startDateGroup');
    const endDateGroup = document.getElementById('endDateGroup');
    const customDurationGroup = document.getElementById('customDurationGroup');

    // Hide everything first
    singleDateGroup.style.display = 'none';
    halfDayPeriodGroup.style.display = 'none';
    startDateGroup.style.display = 'none';
    endDateGroup.style.display = 'none';
    customDurationGroup.style.display = 'none';

    if (duration === '0.5') {
        // Half Day
        singleDateGroup.style.display = 'block';
        halfDayPeriodGroup.style.display = 'block';
    } else if (duration === '1') {
        // One Day
        singleDateGroup.style.display = 'block';
    } else if (duration === 'custom') {
        // Custom (more than 5 days)
        startDateGroup.style.display = 'block';
        endDateGroup.style.display = 'block';
        customDurationGroup.style.display = 'block';
    } else if (parseInt(duration) > 1) {
        // 2-5 Days
        startDateGroup.style.display = 'block';
        endDateGroup.style.display = 'block';
    }
}




        function exportToExcel() {
            // Simulate Excel export
            alert('Export functionality would be implemented here. Data would be exported to Excel format.');
        }

        function logout() {
            // Toggle between employee and HR view for demo purposes
            if (currentUser === 'employee') {
                switchToHRView();
            } else {
                switchToEmployeeView();
            }
        }

        // Event listeners
        document.getElementById('startDate').addEventListener('change', calculateDurationFromDates);
        document.getElementById('endDate').addEventListener('change', calculateDurationFromDates);
        document.getElementById('customDuration').addEventListener('input', calculateDurationFromDates);

        // Close modal when clicking outside
        document.getElementById('newRequestModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

         // Additional functions for new features
        function viewCalendar() {
            document.getElementById('calendarSection').style.display = 'block';
            generateCalendar();
        }

        function toggleCalendar() {
            const calendar = document.getElementById('calendarSection');
            calendar.style.display = calendar.style.display === 'none' ? 'block' : 'none';
        }

        function viewTeamStatus() {
            document.getElementById('teamSection').style.display = 'block';
        }

        function toggleTeamStatus() {
            const team = document.getElementById('teamSection');
            team.style.display = team.style.display === 'none' ? 'block' : 'none';
        }

        function generateCalendar() {
            const grid = document.getElementById('calendarGrid');
            const today = new Date();
            const currentMonth = today.getMonth();
            const currentYear = today.getFullYear();
            
            // Calendar header days
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            let calendarHTML = '';
            
            // Add day headers
            days.forEach(day => {
                calendarHTML += `<div class="calendar-day" style="font-weight: 600; background: #f8f9fa; text-align: center;">${day}</div>`;
            });
            
            // Get first day of month and number of days
            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            
            // Add empty cells for days before month starts
            for (let i = 0; i < firstDay; i++) {
                calendarHTML += `<div class="calendar-day other-month"></div>`;
            }
            
            // Add days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayOfWeek = (firstDay + day - 1) % 7;
                const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
                let classes = 'calendar-day';
                let indicator = '';
                
                if (isWeekend) classes += ' weekend';
                
                // Check if this day has leave (sample data)
                if (day >= 1 && day <= 5) {
                    classes += ' has-leave';
                    indicator = '<div class="leave-indicator approved"></div>';
                }
                
                calendarHTML += `
                    <div class="${classes}">
                        ${day}
                        ${indicator}
                    </div>
                `;
            }
            
            grid.innerHTML = calendarHTML;
        }

        function previousMonth() {
            showNotification('Previous month functionality would be implemented here', 'info');
        }

        function nextMonth() {
            showNotification('Next month functionality would be implemented here', 'info');
        }

        function addNewUser() {
            showNotification('Add user functionality would be implemented here', 'info');
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => document.body.removeChild(notification), 300);
            }, 3000);
        }

        function submitLeaveRequest() {
            const form = document.getElementById('leaveRequestForm');
            const numberOfDays = document.getElementById('numberOfDays').value;
            const leaveType = document.getElementById('leaveType').value;
            const reason = document.getElementById('reason').value;
            
            // if (!numberOfDays || !leaveType || !reason) {
            //     showNotification('Please fill in all required fields', 'error');
            //     return;
            // }

            let startDate, endDate, duration;
            let halfDayPeriod = null;

            if (numberOfDays === '0.5') {
                // Half day leave
                const singleDate = document.getElementById('singleDate').value;
                if (!singleDate) {
                    showNotification('Please select a date for your half day leave', 'error');
                    return;
                }
                startDate = singleDate;
                endDate = singleDate;
                duration = 0.5;
                halfDayPeriod = document.querySelector('input[name="halfDayPeriod"]:checked').value;
            } else if (numberOfDays === '1') {
                // Single day leave
                const singleDate = document.getElementById('singleDate').value;
                if (!singleDate) {
                    showNotification('Please select a date for your leave', 'error');
                    return;
                }
                startDate = singleDate;
                endDate = singleDate;
                duration = 1;
            } else if (numberOfDays === 'custom') {
                // Custom duration
                const customDuration = document.getElementById('customDuration').value;
                const startDateValue = document.getElementById('startDate').value;
                
                if (!customDuration || !startDateValue) {
                    showNotification('Please enter custom duration and start date', 'error');
                    return;
                }
                
                startDate = startDateValue;
                const start = new Date(startDate);
                const end = new Date(start);
                end.setDate(start.getDate() + parseInt(customDuration) - 1);
                endDate = end.toISOString().split('T')[0];
                duration = parseInt(customDuration);
            } else {
                // Fixed duration (2-5 days)
                const startDateValue = document.getElementById('startDate').value;
                
                if (!startDateValue) {
                    showNotification('Please select a start date', 'error');
                    return;
                }
                
                startDate = startDateValue;
                const start = new Date(startDate);
                const end = new Date(start);
                end.setDate(start.getDate() + parseInt(numberOfDays) - 1);
                endDate = end.toISOString().split('T')[0];
                duration = parseInt(numberOfDays);
            }

            // Check leave balance
            if (leaveType === 'Annual Leave' && duration > 20) {
                showNotification('Insufficient annual leave balance', 'error');
                return;
            }

            const newRequest = {
                id: Date.now(),
                employee: 'John Doe',
                department: 'Engineering',
                type: leaveType,
                reason: reason,
                startDate: startDate,
                endDate: endDate,
                duration: duration,
                halfDayPeriod: halfDayPeriod,
                status: 'pending',
                submitted: new Date().toISOString().split('T')[0],
                comments: ''
            };

            leaveRequests.push(newRequest);
            allRequests.push(newRequest);
            
            closeModal();
            updateDashboard();
            
            let successMessage = `Leave request submitted successfully!`;
            if (halfDayPeriod) {
                successMessage += ` (${halfDayPeriod} half day)`;
            }
            showNotification(successMessage, 'success');
        }

        // Initialize the application
        initializeApp();
    </script>
</body>
</html>